@if (isOpen()) {
  <!-- Modal Overlay -->
  <div
    class="modal-overlay"
    [class.modal-centered]="config().centered"
    (click)="onOverlayClick($event)"
    role="dialog"
    aria-modal="true"
    [attr.aria-labelledby]="title() ? 'modal-title' : null">

    <!-- Modal Container -->
    <div
      #modalElement
      class="modal-container"
      [class]="getSizeClass()"
      tabindex="-1"
      role="document">

      <!-- Modal Header -->
      @if (title() || config().showCloseButton) {
        <div class="modal-header">
          @if (title()) {
            <h2 class="modal-title" id="modal-title">{{ title() }}</h2>
          }

          @if (config().showCloseButton) {
            <button
              class="modal-close-button"
              type="button"
              (click)="onClose()"
              aria-label="Close modal">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <line x1="18" y1="6" x2="6" y2="18"></line>
                <line x1="6" y1="6" x2="18" y2="18"></line>
              </svg>
            </button>
          }
        </div>
      }

      <!-- Modal Body -->
      <div class="modal-body">
        <ng-content></ng-content>
      </div>

      <!-- Modal Footer -->
      @if (showFooter() && (primaryButtonLabel() || secondaryButtonLabel())) {
        <div class="modal-footer">
          @if (secondaryButtonLabel()) {
            <button
              class="modal-button modal-button-secondary"
              type="button"
              [disabled]="loading()"
              (click)="onSecondaryAction()">
              {{ secondaryButtonLabel() }}
            </button>
          }

          @if (primaryButtonLabel()) {
            <button
              class="modal-button modal-button-primary"
              type="button"
              [disabled]="loading()"
              (click)="onPrimaryAction()">
              @if (loading()) {
                <span class="button-spinner"></span>
              }
              {{ primaryButtonLabel() }}
            </button>
          }
        </div>
      }

      <!-- Footer Slot -->
      @if (showFooter() && !primaryButtonLabel() && !secondaryButtonLabel()) {
        <div class="modal-footer">
          <ng-content select="[footer]"></ng-content>
        </div>
      }

    </div>
  </div>
}
